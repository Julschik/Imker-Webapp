exports.id=614,exports.ids=[614],exports.modules={9763:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},618:()=>{},5047:(e,t,r)=>{"use strict";var n=r(7389);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},3464:(e,t,r)=>{"use strict";let n,i;r.d(t,{k:()=>E});var s=r(7577);let o=e=>{let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,s={setState:n,getState:i,getInitialState:()=>o,subscribe:e=>(r.add(e),()=>r.delete(e))},o=t=e(n,i,s);return s},a=e=>e?o(e):o,c=e=>e,u=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>u(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>u(t)(e)}}};var l=r(359);let d={NODE_ENV:"production",API_BASE_URL:process.env.API_BASE_URL||"http://localhost:8787",BACKEND_PROVIDER:process.env.BACKEND_PROVIDER||"selfhosted",SIGNED_URL_TTL_MIN:parseInt(process.env.SIGNED_URL_TTL_MIN||"15"),PUBLIC_COORDS_MODE:process.env.PUBLIC_COORDS_MODE||"hidden",PUBLIC_COORD_PRECISION:parseInt(process.env.PUBLIC_COORD_PRECISION||"2"),FEATURE_BACKUP:"true"===process.env.FEATURE_BACKUP,FEATURE_BULK:"true"===process.env.FEATURE_BULK,FEATURE_REPORTS:"true"===process.env.FEATURE_REPORTS,FEATURE_COMMENTS:"true"===process.env.FEATURE_COMMENTS,FEATURE_GUEST:"true"===process.env.FEATURE_GUEST,FEATURE_OFFLINE_TILES:"true"===process.env.FEATURE_OFFLINE_TILES,FEATURE_WEATHER_PREFETCH:"true"===process.env.FEATURE_WEATHER_PREFETCH,FEATURE_NOTIFICATIONS:"true"===process.env.FEATURE_NOTIFICATIONS,FEATURE_I18N:"true"===process.env.FEATURE_I18N,FEATURE_MANUAL_TRACHT:"true"===process.env.FEATURE_MANUAL_TRACHT,FEATURE_WARTEZEIT_CASCADE:"true"===process.env.FEATURE_WARTEZEIT_CASCADE,AUDIO_MAX_MINUTES:parseInt(process.env.AUDIO_MAX_MINUTES||"10"),AUDIO_MAX_SIZE_MB:parseInt(process.env.AUDIO_MAX_SIZE_MB||"20"),AUDIO_WORKSPACE_QUOTA_GB:parseInt(process.env.AUDIO_WORKSPACE_QUOTA_GB||"2"),AUDIO_RETENTION_DAYS:parseInt(process.env.AUDIO_RETENTION_DAYS||"30")},h=new class{async login(e){try{if((0,l.cM)("AuthService","Attempting login for",e.email),"development"===d.NODE_ENV){(0,l.ZK)("AuthService","Using mock authentication in development");let t={id:"mock-user-1",email:e.email,name:"Test Imker",roles:["admin"],twofaEnabled:!1};return await new Promise(e=>setTimeout(e,1e3)),(0,l.cM)("AuthService","Mock login successful",t.id),t}let t=await fetch(`${this.baseUrl}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(`Login failed: ${t.status}`);let r=await t.json();return(0,l.cM)("AuthService","Login successful",r.id),r}catch(e){throw(0,l.vU)("AuthService","Login failed",e),Error("Anmeldung fehlgeschlagen. Bitte pr\xfcfen Sie Ihre Eingaben.")}}async logout(){try{if((0,l.cM)("AuthService","Logging out user"),"development"===d.NODE_ENV){(0,l.ZK)("AuthService","Mock logout in development");return}await fetch(`${this.baseUrl}/auth/logout`,{method:"POST",credentials:"include"}),(0,l.cM)("AuthService","Logout successful")}catch(e){(0,l.vU)("AuthService","Logout failed",e)}}async getCurrentUser(){try{if((0,l.cM)("AuthService","Fetching current user"),"development"===d.NODE_ENV)return(0,l.ZK)("AuthService","Mock user check in development"),null;let e=await fetch(`${this.baseUrl}/auth/me`,{credentials:"include"});if(!e.ok){if(401===e.status)return(0,l.cM)("AuthService","User not authenticated"),null;throw Error(`Failed to get user: ${e.status}`)}let t=await e.json();return(0,l.cM)("AuthService","Current user fetched",t.id),t}catch(e){return(0,l.vU)("AuthService","Failed to get current user",e),null}}async setupTwoFactor(){try{(0,l.cM)("AuthService","Setting up 2FA");let e=await fetch(`${this.baseUrl}/auth/2fa/setup`,{method:"POST",credentials:"include"});if(!e.ok)throw Error(`2FA setup failed: ${e.status}`);let t=await e.json();return(0,l.cM)("AuthService","2FA setup initiated"),t}catch(e){throw(0,l.vU)("AuthService","2FA setup failed",e),Error("2FA-Einrichtung fehlgeschlagen")}}async verifyTwoFactor(e){try{(0,l.cM)("AuthService","Verifying 2FA code");let t=(await fetch(`${this.baseUrl}/auth/2fa/verify`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({code:e})})).ok;return(0,l.cM)("AuthService","2FA verification result",t),t}catch(e){return(0,l.vU)("AuthService","2FA verification failed",e),!1}}constructor(){this.baseUrl=d.API_BASE_URL}},E=(e=>{let t=a(e),r=e=>(function(e,t=c){let r=s.useSyncExternalStore(e.subscribe,s.useCallback(()=>t(e.getState()),[e,t]),s.useCallback(()=>t(e.getInitialState()),[e,t]));return s.useDebugValue(r),r})(t,e);return Object.assign(r,t),r})((n=(e,t)=>({user:null,isAuthenticated:!1,isLoading:!1,login:async(t,r,n)=>{try{e({isLoading:!0}),(0,l.cM)("Session","Login attempt for",t);let i=await h.login({email:t,password:r,totpCode:n});e({user:i,isAuthenticated:!0,isLoading:!1}),(0,l.cM)("Session","Login successful, user set in session")}catch(t){throw(0,l.vU)("Session","Login failed",t),e({user:null,isAuthenticated:!1,isLoading:!1}),t}},logout:async()=>{try{(0,l.cM)("Session","Logout initiated"),await h.logout(),e({user:null,isAuthenticated:!1,isLoading:!1}),(0,l.cM)("Session","Logout completed, session cleared")}catch(t){(0,l.vU)("Session","Logout error",t),e({user:null,isAuthenticated:!1,isLoading:!1})}},checkAuth:async()=>{try{e({isLoading:!0}),(0,l.cM)("Session","Checking authentication status");let t=await h.getCurrentUser();t?(e({user:t,isAuthenticated:!0,isLoading:!1}),(0,l.cM)("Session","User authenticated",t.id)):(e({user:null,isAuthenticated:!1,isLoading:!1}),(0,l.cM)("Session","User not authenticated"))}catch(t){(0,l.vU)("Session","Auth check failed",t),e({user:null,isAuthenticated:!1,isLoading:!1})}},setLoading:t=>{e({isLoading:t})}}),i={name:"imker-session",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})},(e,t,r)=>{let s,o={storage:function(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var t;let n=e=>null===e?null:JSON.parse(e,void 0),i=null!=(t=r.getItem(e))?t:null;return i instanceof Promise?i.then(n):n(i)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...i},a=!1,c=new Set,l=new Set,d=o.storage;if(!d)return n((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),e(...t)},t,r);let h=()=>{let e=o.partialize({...t()});return d.setItem(o.name,{state:e,version:o.version})},E=r.setState;r.setState=(e,t)=>(E(e,t),h());let A=n((...t)=>(e(...t),h()),t,r);r.getInitialState=()=>A;let v=()=>{var r,n;if(!d)return;a=!1,c.forEach(e=>{var r;return e(null!=(r=t())?r:A)});let i=(null==(n=o.onRehydrateStorage)?void 0:n.call(o,null!=(r=t())?r:A))||void 0;return u(d.getItem.bind(d))(o.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===o.version)return[!1,e.state];if(o.migrate){let t=o.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(r=>{var n;let[i,a]=r;if(e(s=o.merge(a,null!=(n=t())?n:A),!0),i)return h()}).then(()=>{null==i||i(s,void 0),s=t(),a=!0,l.forEach(e=>e(s))}).catch(e=>{null==i||i(void 0,e)})};return r.persist={setOptions:e=>{o={...o,...e},e.storage&&(d=e.storage)},clearStorage:()=>{null==d||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},o.skipHydration||v(),s||A}))},359:(e,t,r)=>{"use strict";function n(e,...t){console.log(`[${e}]`,...t)}function i(e,...t){console.warn(`[${e}]`,...t)}function s(e,...t){console.error(`[${e}]`,...t)}r.d(t,{ZK:()=>i,cM:()=>n,vU:()=>s})},2029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a,metadata:()=>o});var n=r(9510),i=r(5317),s=r.n(i);r(5023);let o={title:"Imker-Webapp",description:"Offline-first Betriebsf\xfchrung f\xfcr Hobby- und Berufsimker",manifest:"/manifest.json",themeColor:"#10b981",viewport:"width=device-width, initial-scale=1, maximum-scale=1"};function a({children:e}){return n.jsx("html",{lang:"de",children:n.jsx("body",{className:s().className,children:e})})}},5023:()=>{}};